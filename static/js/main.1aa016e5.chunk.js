(this.webpackJsonpfile_upload=this.webpackJsonpfile_upload||[]).push([[0],{153:function(e,t,a){e.exports=a(296)},158:function(e,t,a){},175:function(e,t,a){},176:function(e,t,a){},214:function(e,t,a){},215:function(e,t,a){},296:function(e,t,a){"use strict";a.r(t);var n=a(0),l=a.n(n),s=a(6),i=a.n(s),r=a(73),o=a(26),c=a(37),p=a(38),m=a(51),u=a(40),h=a(39),d=(a(110),a(158),a(297)),f=a(302),b=a(300),g=a(48),E=a.n(g),v=a(318),y=a(312),k=a(311),N=a(306),C=a(305),F=(a(175),a(299)),O=(a(176),a(310)),w=a(309),j=a(308),S=a(307),x=function(e){Object(u.a)(a,e);var t=Object(h.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(p.a)(a,[{key:"handelClick",value:function(){this.props.setSelectedApp()}},{key:"render",value:function(){var e=this;return l.a.createElement(F.a,{width:"400px",visible:this.props.visible,title:"Choose an app to open",footer:null,onCancel:function(){return e.handelClick()}},l.a.createElement("ul",{className:"apps"},l.a.createElement("li",{onClick:function(){return e.handelClick()},style:{display:"block"}},l.a.createElement("div",{className:"app"},l.a.createElement("span",{className:"appIcon",style:{backgroundColor:"rgb(0, 109, 217)"}},l.a.createElement(O.a,null)),l.a.createElement("span",{className:"appName"},"DropBox"))),l.a.createElement("li",{onClick:function(){return e.handelClick()},style:{display:this.props.app?this.props.app[0]:"block"}},l.a.createElement(r.b,{to:{pathname:"http://101.200.153.106:3000/markdown",search:encodeURIComponent(this.props.file)},target:"_blank"},l.a.createElement("div",{className:"app"},l.a.createElement("span",{className:"appIcon",style:{backgroundColor:"rgb(101, 211, 119)"}},l.a.createElement(w.a,null)),l.a.createElement("span",{className:"appName"},"Markdown")))),l.a.createElement("li",{onClick:function(){return e.handelClick()},style:{display:this.props.app?this.props.app[1]:"block"}},l.a.createElement(r.b,{to:{pathname:"http://101.200.153.106:3000/invoice",search:encodeURIComponent(this.props.file)},target:"_blank"},l.a.createElement("div",{className:"app"},l.a.createElement("span",{className:"appIcon",style:{backgroundColor:"rgb(248, 206, 94)"}},l.a.createElement(j.a,null)),l.a.createElement("span",{className:"appName"},"Receipt")))),l.a.createElement("li",{onClick:function(){return e.handelClick()},style:{display:this.props.app?this.props.app[2]:"block"}},l.a.createElement(r.b,{to:{pathname:"http://101.200.153.106:3000/translate",search:encodeURIComponent(this.props.file)},target:"_blank"},l.a.createElement("div",{className:"app"},l.a.createElement("span",{className:"appIcon",style:{backgroundColor:"rgb(203, 43, 41)"}},l.a.createElement(S.a,null)),l.a.createElement("span",{className:"appName"},"Translate"))))))}}]),a}(l.a.Component),I=function(e){Object(u.a)(a,e);var t=Object(h.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).state={visible:!1,file:"",app:["none","none","none"]},n}return Object(p.a)(a,[{key:"openApp",value:function(){this.setState({visible:!1})}},{key:"borderColorLight",value:function(){var e=document.getElementById("fileDropBox");e&&(e.style.borderColor="#379FFF",e.style.backgroundColor="#F8F8F8")}},{key:"borderColorDim",value:function(){var e=document.getElementById("fileDropBox");e&&(e.style.borderColor="#D4D4D4",e.style.backgroundColor="#FFFFFF")}},{key:"handleAddFile",value:function(e){var t=this,a=e.currentTarget.files;if(a){for(var n=this.props.files,l=[],s=0;s<a.length;s++)n.indexOf(a[s].name)>-1?f.a.warn(a[s].name+" already exists."):l.push(a[s]);for(var i=function(e){n.push(l[e].name);var a=new FileReader;switch(a.onload=function(a){E.a.post("http://101.200.153.106:3389/upload",{params:{userName:t.props.userName,type:l[e].type.split("/")[0],name:l[e].name,content:a.target.result.toString()}}).catch((function(e){f.a.error(e)}))},(l[e].type||"").split("/")[0]){case"text":a.readAsText(l[e],"utf8");break;case"image":a.readAsDataURL(l[e])}f.a.success(l[e].name+" has been added.")},r=0;r<l.length;r++)i(r);1===l.length&&(this.setState({visible:!0,file:l[0].name}),"image"===(l[0].type||"").split("/")[0]&&this.setState({app:["none","block","block"]}),"txt"===(l[0].name||"").split(".")[1]&&this.setState({app:["block","none","block"]}),"md"===(l[0].name||"").split(".")[1]&&this.setState({app:["block","none","none"]})),this.props.setFiles(n),e.target.value=[]}}},{key:"render",value:function(){var e=this;return l.a.createElement("div",{className:"fileDropBox",id:"fileDropBox",onMouseEnter:function(){return e.borderColorLight()},onMouseLeave:function(){return e.borderColorDim()}},l.a.createElement(x,{visible:this.state.visible,setSelectedApp:function(){return e.openApp()},file:this.state.file,app:this.state.app}),l.a.createElement("span",{className:"uploadDragIcon"},l.a.createElement(v.a,null)),l.a.createElement("span",{className:"uploadTips"},l.a.createElement(C.a,null),"Click or drag file to this area to upload"),l.a.createElement("input",{type:"file",id:"fileInput",title:"",multiple:!0,onDragEnter:function(){return e.borderColorLight()},onDragLeave:function(){return e.borderColorDim()},onDrop:function(){return e.borderColorDim()},onChange:function(t){return e.handleAddFile(t)}}))}}]),a}(l.a.Component),R=function(e){Object(u.a)(a,e);var t=Object(h.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(p.a)(a,[{key:"render",value:function(){return l.a.createElement(I,{userName:this.props.userName,files:this.props.files,setFiles:this.props.setFiles})}}]),a}(l.a.Component),D=a(304),L=a(313),U=(a(214),function(e){Object(u.a)(a,e);var t=Object(h.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(p.a)(a,[{key:"itemClick",value:function(e){this.props.showFileContent(e)}},{key:"handleDelete",value:function(e){for(var t=[],a=0;a<this.props.files.length;a++)this.props.files[a]!==e&&t.push(this.props.files[a]);this.props.setFiles(t),E.a.post("http://101.200.153.106:3389/delete",{params:{userName:this.props.userName,fileName:e}}).catch((function(e){f.a.error(e)})),f.a.success(e+" has been deleted.")}},{key:"render",value:function(){var e=this,t=this.props.files.map((function(t){return l.a.createElement("li",{key:t.toString()},l.a.createElement("span",{style:{display:"inline-block",width:"80%"},onClick:function(){return e.itemClick(t)}},l.a.createElement("span",null,l.a.createElement(D.a,null)),l.a.createElement("span",{className:"fName"},t)),l.a.createElement("span",{className:"fDelIcon",onClick:function(){return e.handleDelete(t)}},l.a.createElement(L.a,null)))}));return l.a.createElement("ul",{className:"fUl"},t)}}]),a}(l.a.Component)),A=(a(215),a(298)),B=a(58),V=function(e){Object(u.a)(a,e);var t=Object(h.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).state={fileContent:null,visible:!1,file:null,app:["block","block","block"]},n.showFileContent=n.showFileContent.bind(Object(m.a)(n)),n.handleSubmit=n.handleSubmit.bind(Object(m.a)(n)),n.handleReset=n.handleReset.bind(Object(m.a)(n)),n.formRef=l.a.createRef(),n}return Object(p.a)(a,[{key:"showFileContent",value:function(e){var t=this,a=e.split(".")[1];"txt"===a||"md"===a?E.a.get("http://101.200.153.106:3389/markdown",{params:{file:e}}).then((function(a){t.setState({file:e,fileContent:l.a.createElement("textarea",{className:"preview-text",value:a.data||"",readOnly:!0})})})).catch((function(e){})):this.setState({file:e,fileContent:l.a.createElement("img",{className:"preview-img",src:"http://101.200.153.106:3389/files/"+e,alt:""})})}},{key:"handleSubmit",value:function(){this.state.fileContent?this.openApp():f.a.warning("No file selected!")}},{key:"openApp",value:function(){this.setState({visible:!this.state.visible})}},{key:"handleReset",value:function(){this.setState({fileContent:"",formItems:null}),this.formRef.current&&this.formRef.current.resetFields()}},{key:"render",value:function(){var e=this;return l.a.createElement("div",{className:"extractPageComponent"},l.a.createElement("div",{className:"extractLeft"},l.a.createElement("div",{className:"listTitle"},l.a.createElement("span",null,"File List")),l.a.createElement(U,{userName:this.props.userName,files:this.props.files,setFiles:this.props.setFiles,showFileContent:this.showFileContent})),l.a.createElement("div",{className:"extractRight"},l.a.createElement("div",{className:"extractTop"},this.state.fileContent),l.a.createElement("div",{className:"extractBottom"},l.a.createElement("div",{className:"infoFormBox"},l.a.createElement(A.a,{ref:this.formRef,labelCol:{span:6}},this.state.formItems,l.a.createElement(A.a.Item,{wrapperCol:{offset:12,span:16}},l.a.createElement(B.a,{type:"primary",htmlType:"submit",onClick:this.handleSubmit},"Submit"),l.a.createElement(B.a,{htmlType:"button",onClick:this.handleReset},"Reset")))))),l.a.createElement(x,{userName:this.props.userName,visible:this.state.visible,app:this.state.app,setSelectedApp:function(){return e.openApp()},file:this.state.file}))}}]),a}(l.a.Component),P=a(301),T=a(303),H=a(317),M=a(316),_=a(315),z=a(314),q=function(e){Object(u.a)(a,e);var t=Object(h.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).formRef=l.a.createRef(),n}return Object(p.a)(a,[{key:"handleLogin",value:function(){var e=this,t=this.formRef.current.getFieldValue(),a=t.userName,n=t.password,l=t.remember;a&&n&&E.a.get("http://101.200.153.106:3389/login",{params:{userName:a,password:n}}).then((function(t){1===t.data?(e.props.setUserName(a),l&&localStorage.setItem("lastUser",a),e.props.setVisibility(!1)):f.a.error("wrong password or user not exist!")})).catch((function(e){f.a.error(e)}))}},{key:"handleCancel",value:function(){this.props.setVisibility(!1)}},{key:"render",value:function(){var e=this;return l.a.createElement(F.a,{width:"450px",visible:this.props.visible,title:"Login",footer:null,onCancel:function(){return e.handleCancel()}},l.a.createElement(A.a,{ref:this.formRef,labelCol:{span:6}},l.a.createElement(A.a.Item,{name:"userName",rules:[{required:!0}]},l.a.createElement(P.a,{size:"large",placeholder:"user name",prefix:l.a.createElement(H.a,null)})),l.a.createElement(A.a.Item,{name:"password",rules:[{required:!0}]},l.a.createElement(P.a.Password,{placeholder:"password",prefix:l.a.createElement(M.a,null),iconRender:function(e){return e?l.a.createElement(_.a,null):l.a.createElement(z.a,null)}})),l.a.createElement(A.a.Item,{name:"remember",valuePropName:"checked"},l.a.createElement(T.a,null,"Remember me")),l.a.createElement(A.a.Item,{wrapperCol:{offset:10,span:8}},l.a.createElement(B.a,{type:"primary",htmlType:"submit",onClick:function(){return e.handleLogin()}},"Login"))))}}]),a}(l.a.Component),J=d.a.Header,X=d.a.Sider,K=d.a.Content,G=function(e){Object(u.a)(a,e);var t=Object(h.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).handleResize=function(e){n.setState({height:e.target.innerHeight})},n.toggle=function(){n.setState({collapsed:!n.state.collapsed});var e=document.getElementsByClassName("user-name")[0],t=document.getElementsByClassName("user-icon")[0],a=document.getElementsByClassName("login")[0];e.style.display=n.state.collapsed?"inline-block":"none",a.style.display=n.state.collapsed?"inline-block":"none",t.style.left=n.state.collapsed?"10px":"50%",t.style.transform=n.state.collapsed?"translateX(0)":"translateX(-50%)"},n.state={collapsed:!1,curPage:"upload",files:[],height:window.innerHeight,loginVisible:!1,userName:""},n.setFiles=n.setFiles.bind(Object(m.a)(n)),n.setUserName=n.setUserName.bind(Object(m.a)(n)),n.loginVisibility=n.loginVisibility.bind(Object(m.a)(n)),n}return Object(p.a)(a,[{key:"componentDidMount",value:function(){window.addEventListener("resize",this.handleResize.bind(this));var e=localStorage.getItem("lastUser");e?this.setUserName(e):this.setState({loginVisible:!0})}},{key:"setPage",value:function(e){this.setState({curPage:e})}},{key:"setFiles",value:function(e){this.setState({files:e})}},{key:"loginVisibility",value:function(e){this.setState({loginVisible:e})}},{key:"setUserName",value:function(e){var t=this;this.setState({userName:e}),E.a.get("http://101.200.153.106:3389/getFiles",{params:{userName:e}}).then((function(e){var a=e.data;a.length>0&&t.setState({files:a.split(",")})})).catch((function(e){f.a.error(e)}))}},{key:"handelLoginClick",value:function(){this.state.userName.length>0?(this.setState({userName:"",files:[]}),localStorage.removeItem("lastUser")):this.setState({loginVisible:!0})}},{key:"render",value:function(){var e,t=this;switch(this.state.curPage){case"upload":e=l.a.createElement(R,{userName:this.state.userName,files:this.state.files,setFiles:this.setFiles});break;case"extract":e=l.a.createElement(V,{userName:this.state.userName,files:this.state.files,setFiles:this.setFiles})}return l.a.createElement(d.a,null,l.a.createElement(X,{trigger:null,collapsible:!0,collapsed:this.state.collapsed},l.a.createElement("div",{className:"user"},l.a.createElement("div",{className:"user-icon"}," ",this.state.userName[0]),l.a.createElement("div",{className:"user-name"}," ",this.state.userName.length>0?this.state.userName:"NULL"," "),l.a.createElement("button",{className:"login",onClick:function(){return t.handelLoginClick()}}," ",this.state.userName.length>0?"logout":"login"," ")),l.a.createElement(b.a,{theme:"dark",mode:"inline",defaultSelectedKeys:["1"]},l.a.createElement(b.a.Item,{key:"1",icon:l.a.createElement(v.a,null),onClick:function(){return t.setPage("upload")}},"Add new files"),l.a.createElement(b.a.Item,{key:"2",icon:l.a.createElement(y.a,null),onClick:function(){return t.setPage("extract")}},"My files"))),l.a.createElement(d.a,{className:"site-layout"},l.a.createElement(J,{className:"site-layout-background",style:{padding:0}},l.a.createElement(this.state.collapsed?k.a:N.a,{className:"trigger",onClick:this.toggle})),l.a.createElement(K,{className:"site-layout-background",style:{margin:"24px 16px",padding:24,minHeight:this.state.height-115,maxHeight:850}},e)),l.a.createElement(q,{visible:this.state.loginVisible,setVisibility:this.loginVisibility,setUserName:this.setUserName}))}}]),a}(l.a.Component);var Q=function(){return l.a.createElement(r.a,null,l.a.createElement("div",null,l.a.createElement(o.a,{exact:!0,path:"/",component:G})))};i.a.render(l.a.createElement(Q,null),document.getElementById("root"))}},[[153,1,2]]]);
//# sourceMappingURL=main.1aa016e5.chunk.js.map